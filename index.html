<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Color Tab App</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js"></script>
  <script defer src="/chroma.min.js" onerror="console.error('Chroma.js CDN failed, loaded local fallback')"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
    }
    .nav button {
      margin: 5px;
      padding: 10px 15px;
      cursor: pointer;
    }
    .tab {
      display: none;
      padding: 20px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    .tab.active {
      display: block !important;
      visibility: visible !important;
    }
    .swatch {
      width: 100px;
      height: 100px;
      margin: 10px;
      display: inline-block;
      border: 1px solid #333;
    }
    .input-container {
      margin-bottom: 15px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .help-text {
      font-size: 0.9em;
      color: #666;
    }
  </style>
  <script>
    const customMaps = {
      viridis: ['#440154', '#482475', '#3f4a8a', '#31688e', '#26828e', '#1f9e89', '#35b779', '#6ece58', '#b5de2b', '#fde725'],
      plasma: ['#0d0887', '#3e049c', '#6300a7', '#8707a6', '#a31895', '#bf2979', '#d8465b', '#eb6a38', '#f7931a', '#f9cb35'],
      magma: ['#000004', '#160b39', '#3a0c63', '#63197f', '#8a2482', '#b02978', '#d24163', '#ed694b', '#f9943a', '#fcbf49'],
      cividis: ['#00224e', '#003971', '#1a4e7e', '#37607d', '#55707c', '#72807c', '#8f9082', '#ada38c', '#ccbf9f', '#ede2b4'],
      YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58', '#0c2c84'],
      BuGn: ['#f7fcfd', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081', '#08589e'],
      Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2']
    };

    function showTab(tabId) {
      console.log(`Showing tab: ${tabId}`);
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      const target = document.getElementById(tabId);
      if (target) {
        target.classList.add('active');
        console.log(`Tab ${tabId} set to active`);
      } else {
        console.error(`Tab not found: ${tabId}`);
      }
    }
  </script>
</head>
<body>
  <h1>ðŸŽ¨ Color Tools App</h1>
  <div class="nav">
    <button data-tab="swatch" onclick="showTab('swatch')">Color Swatches</button>
    <button data-tab="converter" onclick="showTab('converter')">RGBA â†” HEX Converter</button>
    <button data-tab="palette" onclick="showTab('palette')">Palette Viewer</button>
    <button data-tab="gallery" onclick="showTab('gallery')">Gradient Gallery</button>
    <button data-tab="copilot" onclick="showTab('copilot')">Copilot</button>
  </div>

  <!-- Tab 1: Swatch -->
  <div id="swatch" class="tab active">
    <h2>Color Swatches</h2>
    <div class="input-container">
      <label for="colorInput">Enter a list of colors (HEX or RGBA):</label>
      <input type="text" id="colorInput" placeholder="e.g. #fdab33, (0.2, 0.6, 0.8, 0.7), #33fdab, (0.8, 0.2, 0.5, 1.0)">
      <button onclick="generateSwatches()">Generate Swatches</button>
    </div>
    <p class="help-text">
      Examples of valid formats:<br>
      Single: <code>#fdab33</code> or <code>(0.2, 0.6, 0.8, 0.7)</code><br>
      Multiple: <code>#fdab33, (0.2, 0.6, 0.8, 0.7), #33fdab, (0.8, 0.2, 0.5, 1.0)</code>
    </p>
    <div id="swatchContainer" style="display: flex; flex-wrap: wrap;"></div>
    <script>
      function generateSwatches() {
        const rawInput = document.getElementById('colorInput').value;
        const swatchContainer = document.getElementById('swatchContainer');
        swatchContainer.innerHTML = '';
        try {
          const colors = [];
          const regex = /#(?:[0-9a-fA-F]{3}){1,2}|rgba?\s*\(([^)]+)\)|\(([^)]+)\)/g;
          const matches = rawInput.match(regex);
          matches.forEach(match => {
            match = match.trim();
            if (match.startsWith('#')) {
              colors.push(match);
            } else {
              const inner = match.replace(/[()]/g, '');
              const rgbaValues = inner.split(',').map(v => parseFloat(v.trim()));
              if (rgbaValues.length === 4 && rgbaValues.every(v => !isNaN(v))) {
                colors.push(rgbaValues);
              }
            }
          });
          if (!colors.length) throw new Error("No valid colors found.");
          colors.forEach(color => {
            const swatch = document.createElement('div');
            swatch.className = 'swatch';
            swatch.style.backgroundColor = Array.isArray(color) ? `rgba(${color.join(',')})` : color;
            const label = document.createElement('div');
            label.style.textAlign = 'center';
            label.style.marginTop = '5px';
            label.style.fontSize = '0.9em';
            label.innerText = Array.isArray(color) ? `rgba(${color.join(',')})` : color;
            const wrapper = document.createElement('div');
            wrapper.style.margin = '10px';
            wrapper.style.textAlign = 'center';
            wrapper.appendChild(swatch);
            wrapper.appendChild(label);
            swatchContainer.appendChild(wrapper);
          });
        } catch (error) {
          swatchContainer.innerHTML = '<p style="color: red;">Could not parse your input. Try using HEX codes and RGBA in parentheses.</p>';
        }
      }
    </script>
  </div>

  <!-- Tab 2: RGBA â†” HEX Converter -->
  <div id="converter" class="tab">
    <h2>RGBA â†” HEX Converter</h2>
    <div class="input-container">
      <label for="colorConverterInput">Enter HEX or RGBA values:</label>
      <input type="text" id="colorConverterInput" placeholder="e.g. rgba(0, 153, 102, 1), #ff6432, rgba(0, 0, 255, 0.8)">
      <button onclick="convertBidirectional()">Convert & Visualize</button>
    </div>
    <p class="help-text">
      Examples of valid formats:<br>
      Single: <code>#fdab33</code> or <code>(0.2, 0.6, 0.8, 0.7)</code><br>
      Multiple: <code>#fdab33, (0.2, 0.6, 0.8, 0.7), #33fdab, (0.8, 0.2, 0.5, 1.0)</code>
    </p>
    <div id="convertedSwatches" style="display: flex; flex-wrap: wrap;"></div>
    <script>
      function convertBidirectional() {
        const inputStr = document.getElementById("colorConverter
